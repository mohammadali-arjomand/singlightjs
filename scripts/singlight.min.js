class Singlight{mount(t){this.app=document.querySelector(t),document.querySelectorAll("page").forEach(t=>{t.style.display="none"}),document.querySelectorAll("component").forEach(t=>{t.style.display="none"}),document.querySelectorAll("loader").forEach(t=>{t.style.display="none"}),this.router(this.home)}router(t,e=null,l=null){this.toggleLoader(),this.activeRoute=t,void 0===this.routes[t].api?this.controllers(this.routes[t].controller):null!==e&&null!==e.getAttribute("vars")?null===l?this.sendRequest(JSON.parse(e.getAttribute("vars"))):this.sendRequest(JSON.parse(e.getAttribute("vars")),l):null===l?this.sendRequest():this.sendRequest(null,l)}sendRequest(t=null,e=null){async function l(t,e,l=null){let r,i=await (r=null===l?await fetch(t):await fetch(t,{method:"POST",body:l})).json();r.ok&&e.controllers(e.routes[e.activeRoute].controller,i)}let r=this.routes[this.activeRoute].api;null!==t&&(r=this.apiBuilder(r,t)),null===e?l(r,this):l(r,this,e)}apiBuilder(t,e){let l;for(l in e)t=t.replaceAll("::"+l,e[l]);return t}controllers(t,e=null){null===e?this.data=t():this.data=t(e),this.toggleLoader(),this.pageSwitcher()}pageSwitcher(){if(void 0===this.data.redirect){let t=document.querySelector("page[name="+this.data.page+"]");void 0!==this.data.title?document.title=this.data.title:null!==t.getAttribute("title")&&(document.title=t.getAttribute("title")),this.app.innerHTML=t.innerHTML,this.pageRender()}else if(void 0!==this.data.variables){let e=document.createElement("route");e.setAttribute("vars",JSON.stringify(this.data.variables)),this.router(this.data.redirect,e)}else this.router(this.data.redirect)}pageRender(){let t=this.data.compact;if(void 0!==t){let e;for(e in t)this.app.innerHTML=this.app.innerHTML.replaceAll("::"+e,t[e])}this.pageScanner()}pageScanner(){this.app.querySelectorAll("route").forEach(t=>{t.addEventListener("click",e=>this.router(t.getAttribute("to"),t))}),this.app.querySelectorAll("form[route]").forEach(t=>{t.addEventListener("submit",e=>this.pageForms(e,t))})}pageForms(t,e){t.preventDefault();let l=new FormData(e);this.router(e.getAttribute("route"),e,l)}toggleLoader(){let t=document.querySelector("loader");null!==t&&("none"===t.style.display?t.style.display="block":t.style.display="none")}}class Component{constructor(){this.output=""}add(t,e){let l=document.querySelector("component[name="+t+"]").innerHTML,r;for(r in e)l=l.replaceAll("::"+r,e[r]);this.output+=l}get(){return this.output}}